<%- include('../partials/head', {titleName: "AdMob Settings" }) %>

    <body data-sidebar="dark" data-layout-mode="dark" data-topbar="light">

        <!-- <body data-layout="horizontal" data-topbar="colored"> -->

        <!-- Begin page -->
        <div id="layout-wrapper">

            <%- include('../partials/page_top') %>

                <!-- ========== Left Sidebar Start ========== -->
                <%- include('../partials/side_menu', {selected: 12}) %>
                    <!-- Left Sidebar End -->

                    <!-- ============================================================== -->
                    <!-- Start right Content here -->
                    <!-- ============================================================== -->
                    <div class="main-content">

                        <div class="page-content">
                            <div class="container-fluid">

                                <!-- start page title -->
                                <div class="row">
                                    <% if (user.power==0) { %>
                                        <div class="col-12">
                                            <div class="alert alert-warning" role="alert">
                                                This is a demo account. Any changes you make will not be saved.
                                            </div>
                                        </div>
                                        <% } %>
                                            <div class="col-12">
                                                <div
                                                    class="page-title-box d-flex align-items-center justify-content-between">
                                                    <h4 class="mb-0">Admob Settings</h4>
                                                </div>
                                            </div>
                                </div>
                                <!-- end page title -->
                                <div class="row mb-4">
                                    <div class="col-xl-6">
                                        <div class="card h-100">
                                            <div class="card-body">
                                                <div class="text-muted">
                                                    <h5 class="font-size-16">Adverts configurations</h5>
                                                    <div id="alertContainer"></div>
                                                    <div class="table-responsive mt-4">
                                                        <div class="needs-validation" novalidate>
                                                            <div>
                                                                <p class="mb-1">AdMob enabled?</p>
                                                                <select class="form-control form-select"
                                                                    id="admob_enabled">
                                                                    <option value="enabled" <%= config.admobEnabled === "enabled" ? "selected" : "" %>>Enabled</option>
                                                                    <option value="disabled" <%= config.admobEnabled === "disabled" ? "selected" : "" %>>Disabled</option>
                                                                </select>
                                                            </div>
                                                            <div class="mt-4">
                                                                <p class="mb-1">App ID:</p>
                                                                <input type="text" class="form-control"
                                                                    id="admob_app_id" placeholder="Enter AdMob App ID" value="<%= config.admobAppId %>"
                                                                    required>
                                                                <div class="invalid-feedback">
                                                                    Enter your AdMob App ID which you can find <a
                                                                        href="https://support.google.com/admob/answer/7356431?hl=en">here</a>.
                                                                </div>
                                                            </div>
                                                            <div class="mt-4">
                                                                <p class="mb-1">Banner ID:</p>
                                                                <input type="text" class="form-control"
                                                                    id="admob_banner_id"
                                                                    placeholder="Enter AdMob Banner ID"
                                                                    value="<%= config.admobBannerId %>"
                                                                    required></textarea>
                                                                <div class="invalid-feedback">
                                                                    Enter the banner ID for banner placements.
                                                                </div>
                                                            </div>
                                                            <div class="mt-4">
                                                                <p class="mb-1">Interstitial ID:</p>
                                                                <input type="text" class="form-control"
                                                                    id="admob_interstitial_id"
                                                                    value="<%= config.admobInterId %>"
                                                                    placeholder="Enter AdMob Interstitial ID"
                                                                    required></textarea>
                                                                <div class="invalid-feedback">
                                                                    Enter the native ID for Interstitial banner
                                                                    placements.
                                                                </div>
                                                            </div>
                                                            <div class="mt-4">
                                                                <p class="mb-1">Native ID:</p>
                                                                <input type="text" class="form-control"
                                                                    id="admob_native_id"
                                                                    value="<%= config.admobNativeId %>"
                                                                    placeholder="Enter AdMob Native ID"
                                                                    required></textarea>
                                                                <div class="invalid-feedback">
                                                                    Enter the native ID for native banner placements.
                                                                </div>
                                                            </div>
                                                            <div class="d-flex flex-wrap gap-3 mt-3">
                                                                <a type="submit" id="admobSave"
                                                                    class="btn btn-primary waves-effect waves-light w-md">Save</a>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!-- end row -->

                            </div> <!-- container-fluid -->
                        </div>
                        <!-- end main content-->
                        <%- include('../partials/footer') %>
                    </div>
                    <!-- END layout-wrapper -->


                    <!-- Right Sidebar -->
                    <%- include('../partials/right_sidebar') %>
                        <!-- /Right-bar -->

                        <!-- Right bar overlay-->
                        <div class="rightbar-overlay"></div>

                        <!-- JAVASCRIPT -->
                        <!-- JAVASCRIPT -->
                        <script src="../assets/libs/jquery/jquery.min.js"></script>
                        <script src="../assets/libs/bootstrap/js/bootstrap.bundle.min.js"></script>
                        <script src="../assets/libs/metismenu/metisMenu.min.js"></script>
                        <script src="../assets/libs/simplebar/simplebar.min.js"></script>
                        <script src="../assets/libs/node-waves/waves.min.js"></script>
                        <script src="../assets/libs/waypoints/lib/jquery.waypoints.min.js"></script>
                        <script src="../assets/libs/jquery.counterup/jquery.counterup.min.js"></script>
                        <script src="../assets/libs/apexcharts/apexcharts.min.js"></script>
                        <script src="../assets/js/search.js"></script>
                        <script src="../assets/js/pages/dashboard.init.js"></script>

                        <!-- App js -->
                        <script src="../assets/js/app.js"></script>
                        <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
                            integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
                            crossorigin="anonymous"></script>
                        <script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js"
                            integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
                            crossorigin="anonymous"></script>
                        <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js"
                            integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
                            crossorigin="anonymous"></script>
                        <!-- App js -->
                        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
                        <script src="../assets/js/search.js"></script>
                        <script src="assets/libs/parsleyjs/parsley.min.js"></script>
                        <script src="assets/js/pages/form-validation.init.js"></script>
                        <script>
                            $(document).ready(function () {
                                $('#alertContainer').empty();
                                $("#admobSave").click(function () {
                                    var admobEnabled = $('#admob_enabled').val();
                                    var admobAppId = $('#admob_app_id').val();
                                    var admobNativeId = $('#admob_banner_id').val();
                                    var admobInterId = $('#admob_interstitial_id').val();
                                    var admobBannerId = $('#admob_native_id').val();
                                    saveAdmob(admobEnabled, admobAppId, admobNativeId, admobInterId, admobBannerId);
                                });
                            });
                            async function saveAdmob(admobEnabled, admobAppId, admobNativeId, admobInterId, admobBannerId) {
                                $('#alertContainer').empty();

                                $('#admobSave').addClass("disabled");
                                $('#admobSave').html('Saving');

                                $.ajax({
                                    type: "POST",
                                    url: "/admin/saveAdmob",
                                    data: {
                                        admobEnabled: admobEnabled,
                                        admobAppId: admobAppId,
                                        admobNativeId: admobNativeId,
                                        admobInterId: admobInterId,
                                        admobBannerId: admobBannerId
                                    },
                                    success: function (res) {
                                        if (res.status === 'success') {
                                            $('#agoraSave').removeClass("disabled");
                                            $('#agoraSave').html('Save');

                                            $('#alertContainer').html(`
                <div class="alert alert-success alert-dismissible fade show" role="alert">
                ${res.message}
                </div>
                `);
                                            setTimeout(function () {
                                                $('#alertContainer .alert').hide();
                                            }, 1000);
                                        }
                                    },
                                    dataType: "json",
                                });
                            }
                        </script>
    </body>

    </html>